import{E as _e,b as Y,V as C,c as M,d as te,Q as se,O as ye,e as re}from"./three.module-2hxVk-Lt.js";var z=Object.freeze({Linear:Object.freeze({None:function(e){return e},In:function(e){return this.None(e)},Out:function(e){return this.None(e)},InOut:function(e){return this.None(e)}}),Quadratic:Object.freeze({In:function(e){return e*e},Out:function(e){return e*(2-e)},InOut:function(e){return(e*=2)<1?.5*e*e:-.5*(--e*(e-2)-1)}}),Cubic:Object.freeze({In:function(e){return e*e*e},Out:function(e){return--e*e*e+1},InOut:function(e){return(e*=2)<1?.5*e*e*e:.5*((e-=2)*e*e+2)}}),Quartic:Object.freeze({In:function(e){return e*e*e*e},Out:function(e){return 1- --e*e*e*e},InOut:function(e){return(e*=2)<1?.5*e*e*e*e:-.5*((e-=2)*e*e*e-2)}}),Quintic:Object.freeze({In:function(e){return e*e*e*e*e},Out:function(e){return--e*e*e*e*e+1},InOut:function(e){return(e*=2)<1?.5*e*e*e*e*e:.5*((e-=2)*e*e*e*e+2)}}),Sinusoidal:Object.freeze({In:function(e){return 1-Math.sin((1-e)*Math.PI/2)},Out:function(e){return Math.sin(e*Math.PI/2)},InOut:function(e){return .5*(1-Math.sin(Math.PI*(.5-e)))}}),Exponential:Object.freeze({In:function(e){return e===0?0:Math.pow(1024,e-1)},Out:function(e){return e===1?1:1-Math.pow(2,-10*e)},InOut:function(e){return e===0?0:e===1?1:(e*=2)<1?.5*Math.pow(1024,e-1):.5*(-Math.pow(2,-10*(e-1))+2)}}),Circular:Object.freeze({In:function(e){return 1-Math.sqrt(1-e*e)},Out:function(e){return Math.sqrt(1- --e*e)},InOut:function(e){return(e*=2)<1?-.5*(Math.sqrt(1-e*e)-1):.5*(Math.sqrt(1-(e-=2)*e)+1)}}),Elastic:Object.freeze({In:function(e){return e===0?0:e===1?1:-Math.pow(2,10*(e-1))*Math.sin((e-1.1)*5*Math.PI)},Out:function(e){return e===0?0:e===1?1:Math.pow(2,-10*e)*Math.sin((e-.1)*5*Math.PI)+1},InOut:function(e){return e===0?0:e===1?1:(e*=2,e<1?-.5*Math.pow(2,10*(e-1))*Math.sin((e-1.1)*5*Math.PI):.5*Math.pow(2,-10*(e-1))*Math.sin((e-1.1)*5*Math.PI)+1)}}),Back:Object.freeze({In:function(e){var i=1.70158;return e===1?1:e*e*((i+1)*e-i)},Out:function(e){var i=1.70158;return e===0?0:--e*e*((i+1)*e+i)+1},InOut:function(e){var i=2.5949095;return(e*=2)<1?.5*(e*e*((i+1)*e-i)):.5*((e-=2)*e*((i+1)*e+i)+2)}}),Bounce:Object.freeze({In:function(e){return 1-z.Bounce.Out(1-e)},Out:function(e){return e<1/2.75?7.5625*e*e:e<2/2.75?7.5625*(e-=1.5/2.75)*e+.75:e<2.5/2.75?7.5625*(e-=2.25/2.75)*e+.9375:7.5625*(e-=2.625/2.75)*e+.984375},InOut:function(e){return e<.5?z.Bounce.In(e*2)*.5:z.Bounce.Out(e*2-1)*.5+.5}}),generatePow:function(e){return e===void 0&&(e=4),e=e<Number.EPSILON?Number.EPSILON:e,e=e>1e4?1e4:e,{In:function(i){return Math.pow(i,e)},Out:function(i){return 1-Math.pow(1-i,e)},InOut:function(i){return i<.5?Math.pow(i*2,e)/2:(1-Math.pow(2-i*2,e))/2+.5}}}}),R=function(){return performance.now()},oe=function(){function e(){this._tweens={},this._tweensAddedDuringUpdate={}}return e.prototype.getAll=function(){var i=this;return Object.keys(this._tweens).map(function(n){return i._tweens[n]})},e.prototype.removeAll=function(){this._tweens={}},e.prototype.add=function(i){this._tweens[i.getId()]=i,this._tweensAddedDuringUpdate[i.getId()]=i},e.prototype.remove=function(i){delete this._tweens[i.getId()],delete this._tweensAddedDuringUpdate[i.getId()]},e.prototype.update=function(i,n){i===void 0&&(i=R()),n===void 0&&(n=!1);var t=Object.keys(this._tweens);if(t.length===0)return!1;for(;t.length>0;){this._tweensAddedDuringUpdate={};for(var r=0;r<t.length;r++){var f=this._tweens[t[r]],l=!n;f&&f.update(i,l)===!1&&!n&&delete this._tweens[t[r]]}t=Object.keys(this._tweensAddedDuringUpdate)}return!0},e}(),D={Linear:function(e,i){var n=e.length-1,t=n*i,r=Math.floor(t),f=D.Utils.Linear;return i<0?f(e[0],e[1],t):i>1?f(e[n],e[n-1],n-t):f(e[r],e[r+1>n?n:r+1],t-r)},Bezier:function(e,i){for(var n=0,t=e.length-1,r=Math.pow,f=D.Utils.Bernstein,l=0;l<=t;l++)n+=r(1-i,t-l)*r(i,l)*e[l]*f(t,l);return n},CatmullRom:function(e,i){var n=e.length-1,t=n*i,r=Math.floor(t),f=D.Utils.CatmullRom;return e[0]===e[n]?(i<0&&(r=Math.floor(t=n*(1+i))),f(e[(r-1+n)%n],e[r],e[(r+1)%n],e[(r+2)%n],t-r)):i<0?e[0]-(f(e[0],e[0],e[1],e[1],-t)-e[0]):i>1?e[n]-(f(e[n],e[n],e[n-1],e[n-1],t-n)-e[n]):f(e[r?r-1:0],e[r],e[n<r+1?n:r+1],e[n<r+2?n:r+2],t-r)},Utils:{Linear:function(e,i,n){return(i-e)*n+e},Bernstein:function(e,i){var n=D.Utils.Factorial;return n(e)/n(i)/n(e-i)},Factorial:function(){var e=[1];return function(i){var n=1;if(e[i])return e[i];for(var t=i;t>1;t--)n*=t;return e[i]=n,n}}(),CatmullRom:function(e,i,n,t,r){var f=(n-e)*.5,l=(t-i)*.5,u=r*r,p=r*u;return(2*i-2*n+f+l)*p+(-3*i+3*n-2*f-l)*u+f*r+i}}},W=function(){function e(){}return e.nextId=function(){return e._nextId++},e._nextId=0,e}(),B=new oe,ge=function(){function e(i,n){n===void 0&&(n=B),this._object=i,this._group=n,this._isPaused=!1,this._pauseStart=0,this._valuesStart={},this._valuesEnd={},this._valuesStartRepeat={},this._duration=1e3,this._isDynamic=!1,this._initialRepeat=0,this._repeat=0,this._yoyo=!1,this._isPlaying=!1,this._reversed=!1,this._delayTime=0,this._startTime=0,this._easingFunction=z.Linear.None,this._interpolationFunction=D.Linear,this._chainedTweens=[],this._onStartCallbackFired=!1,this._onEveryStartCallbackFired=!1,this._id=W.nextId(),this._isChainStopped=!1,this._propertiesAreSetUp=!1,this._goToEnd=!1}return e.prototype.getId=function(){return this._id},e.prototype.isPlaying=function(){return this._isPlaying},e.prototype.isPaused=function(){return this._isPaused},e.prototype.to=function(i,n){if(n===void 0&&(n=1e3),this._isPlaying)throw new Error("Can not call Tween.to() while Tween is already started or paused. Stop the Tween first.");return this._valuesEnd=i,this._propertiesAreSetUp=!1,this._duration=n,this},e.prototype.duration=function(i){return i===void 0&&(i=1e3),this._duration=i,this},e.prototype.dynamic=function(i){return i===void 0&&(i=!1),this._isDynamic=i,this},e.prototype.start=function(i,n){if(i===void 0&&(i=R()),n===void 0&&(n=!1),this._isPlaying)return this;if(this._group&&this._group.add(this),this._repeat=this._initialRepeat,this._reversed){this._reversed=!1;for(var t in this._valuesStartRepeat)this._swapEndStartRepeatValues(t),this._valuesStart[t]=this._valuesStartRepeat[t]}if(this._isPlaying=!0,this._isPaused=!1,this._onStartCallbackFired=!1,this._onEveryStartCallbackFired=!1,this._isChainStopped=!1,this._startTime=i,this._startTime+=this._delayTime,!this._propertiesAreSetUp||n){if(this._propertiesAreSetUp=!0,!this._isDynamic){var r={};for(var f in this._valuesEnd)r[f]=this._valuesEnd[f];this._valuesEnd=r}this._setupProperties(this._object,this._valuesStart,this._valuesEnd,this._valuesStartRepeat,n)}return this},e.prototype.startFromCurrentValues=function(i){return this.start(i,!0)},e.prototype._setupProperties=function(i,n,t,r,f){for(var l in t){var u=i[l],p=Array.isArray(u),y=p?"array":typeof u,b=!p&&Array.isArray(t[l]);if(!(y==="undefined"||y==="function")){if(b){var c=t[l];if(c.length===0)continue;for(var x=[u],g=0,w=c.length;g<w;g+=1){var a=this._handleRelativeValue(u,c[g]);if(isNaN(a)){b=!1,console.warn("Found invalid interpolation list. Skipping.");break}x.push(a)}b&&(t[l]=x)}if((y==="object"||p)&&u&&!b){n[l]=p?[]:{};var o=u;for(var _ in o)n[l][_]=o[_];r[l]=p?[]:{};var c=t[l];if(!this._isDynamic){var O={};for(var _ in c)O[_]=c[_];t[l]=c=O}this._setupProperties(o,n[l],c,r[l],f)}else(typeof n[l]>"u"||f)&&(n[l]=u),p||(n[l]*=1),b?r[l]=t[l].slice().reverse():r[l]=n[l]||0}}},e.prototype.stop=function(){return this._isChainStopped||(this._isChainStopped=!0,this.stopChainedTweens()),this._isPlaying?(this._group&&this._group.remove(this),this._isPlaying=!1,this._isPaused=!1,this._onStopCallback&&this._onStopCallback(this._object),this):this},e.prototype.end=function(){return this._goToEnd=!0,this.update(1/0),this},e.prototype.pause=function(i){return i===void 0&&(i=R()),this._isPaused||!this._isPlaying?this:(this._isPaused=!0,this._pauseStart=i,this._group&&this._group.remove(this),this)},e.prototype.resume=function(i){return i===void 0&&(i=R()),!this._isPaused||!this._isPlaying?this:(this._isPaused=!1,this._startTime+=i-this._pauseStart,this._pauseStart=0,this._group&&this._group.add(this),this)},e.prototype.stopChainedTweens=function(){for(var i=0,n=this._chainedTweens.length;i<n;i++)this._chainedTweens[i].stop();return this},e.prototype.group=function(i){return i===void 0&&(i=B),this._group=i,this},e.prototype.delay=function(i){return i===void 0&&(i=0),this._delayTime=i,this},e.prototype.repeat=function(i){return i===void 0&&(i=0),this._initialRepeat=i,this._repeat=i,this},e.prototype.repeatDelay=function(i){return this._repeatDelayTime=i,this},e.prototype.yoyo=function(i){return i===void 0&&(i=!1),this._yoyo=i,this},e.prototype.easing=function(i){return i===void 0&&(i=z.Linear.None),this._easingFunction=i,this},e.prototype.interpolation=function(i){return i===void 0&&(i=D.Linear),this._interpolationFunction=i,this},e.prototype.chain=function(){for(var i=[],n=0;n<arguments.length;n++)i[n]=arguments[n];return this._chainedTweens=i,this},e.prototype.onStart=function(i){return this._onStartCallback=i,this},e.prototype.onEveryStart=function(i){return this._onEveryStartCallback=i,this},e.prototype.onUpdate=function(i){return this._onUpdateCallback=i,this},e.prototype.onRepeat=function(i){return this._onRepeatCallback=i,this},e.prototype.onComplete=function(i){return this._onCompleteCallback=i,this},e.prototype.onStop=function(i){return this._onStopCallback=i,this},e.prototype.update=function(i,n){if(i===void 0&&(i=R()),n===void 0&&(n=!0),this._isPaused)return!0;var t,r,f=this._startTime+this._duration;if(!this._goToEnd&&!this._isPlaying){if(i>f)return!1;n&&this.start(i,!0)}if(this._goToEnd=!1,i<this._startTime)return!0;this._onStartCallbackFired===!1&&(this._onStartCallback&&this._onStartCallback(this._object),this._onStartCallbackFired=!0),this._onEveryStartCallbackFired===!1&&(this._onEveryStartCallback&&this._onEveryStartCallback(this._object),this._onEveryStartCallbackFired=!0),r=(i-this._startTime)/this._duration,r=this._duration===0||r>1?1:r;var l=this._easingFunction(r);if(this._updateProperties(this._object,this._valuesStart,this._valuesEnd,l),this._onUpdateCallback&&this._onUpdateCallback(this._object,r),r===1)if(this._repeat>0){isFinite(this._repeat)&&this._repeat--;for(t in this._valuesStartRepeat)!this._yoyo&&typeof this._valuesEnd[t]=="string"&&(this._valuesStartRepeat[t]=this._valuesStartRepeat[t]+parseFloat(this._valuesEnd[t])),this._yoyo&&this._swapEndStartRepeatValues(t),this._valuesStart[t]=this._valuesStartRepeat[t];return this._yoyo&&(this._reversed=!this._reversed),this._repeatDelayTime!==void 0?this._startTime=i+this._repeatDelayTime:this._startTime=i+this._delayTime,this._onRepeatCallback&&this._onRepeatCallback(this._object),this._onEveryStartCallbackFired=!1,!0}else{this._onCompleteCallback&&this._onCompleteCallback(this._object);for(var u=0,p=this._chainedTweens.length;u<p;u++)this._chainedTweens[u].start(this._startTime+this._duration,!1);return this._isPlaying=!1,!1}return!0},e.prototype._updateProperties=function(i,n,t,r){for(var f in t)if(n[f]!==void 0){var l=n[f]||0,u=t[f],p=Array.isArray(i[f]),y=Array.isArray(u),b=!p&&y;b?i[f]=this._interpolationFunction(u,r):typeof u=="object"&&u?this._updateProperties(i[f],l,u,r):(u=this._handleRelativeValue(l,u),typeof u=="number"&&(i[f]=l+(u-l)*r))}},e.prototype._handleRelativeValue=function(i,n){return typeof n!="string"?n:n.charAt(0)==="+"||n.charAt(0)==="-"?i+parseFloat(n):parseFloat(n)},e.prototype._swapEndStartRepeatValues=function(i){var n=this._valuesStartRepeat[i],t=this._valuesEnd[i];typeof t=="string"?this._valuesStartRepeat[i]=this._valuesStartRepeat[i]+parseFloat(t):this._valuesStartRepeat[i]=this._valuesEnd[i],this._valuesEnd[i]=n},e}(),ve="21.0.0",be=W.nextId,j=B,me=j.getAll.bind(j),Ee=j.removeAll.bind(j),we=j.add.bind(j),Oe=j.remove.bind(j),Se=j.update.bind(j),je={Easing:z,Group:oe,Interpolation:D,now:R,Sequence:W,nextId:be,Tween:ge,VERSION:ve,getAll:me,removeAll:Ee,add:we,remove:Oe,update:Se};const X={type:"change"},q={type:"start"},H={type:"end"};class ke extends _e{constructor(i,n){super();const t=this,r={NONE:-1,ROTATE:0,ZOOM:1,PAN:2,TOUCH_ROTATE:3,TOUCH_ZOOM_PAN:4};this.object=i,this.domElement=n,this.domElement.style.touchAction="none",this.enabled=!0,this.screen={left:0,top:0,width:0,height:0},this.rotateSpeed=1,this.zoomSpeed=1.2,this.panSpeed=.3,this.noRotate=!1,this.noZoom=!1,this.noPan=!1,this.staticMoving=!1,this.dynamicDampingFactor=.2,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.keys=["KeyA","KeyS","KeyD"],this.mouseButtons={LEFT:Y.ROTATE,MIDDLE:Y.DOLLY,RIGHT:Y.PAN},this.target=new C;const f=1e-6,l=new C;let u=1,p=r.NONE,y=r.NONE,b=0,c=0,x=0;const g=new C,w=new M,a=new M,o=new C,_=new M,O=new M,m=new M,E=new M,d=[],k={};this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.up0=this.object.up.clone(),this.zoom0=this.object.zoom,this.handleResize=function(){const s=t.domElement.getBoundingClientRect(),h=t.domElement.ownerDocument.documentElement;t.screen.left=s.left+window.pageXOffset-h.clientLeft,t.screen.top=s.top+window.pageYOffset-h.clientTop,t.screen.width=s.width,t.screen.height=s.height};const T=function(){const s=new M;return function(v,S){return s.set((v-t.screen.left)/t.screen.width,(S-t.screen.top)/t.screen.height),s}}(),N=function(){const s=new M;return function(v,S){return s.set((v-t.screen.width*.5-t.screen.left)/(t.screen.width*.5),(t.screen.height+2*(t.screen.top-S))/t.screen.width),s}}();this.rotateCamera=function(){const s=new C,h=new se,v=new C,S=new C,I=new C,A=new C;return function(){A.set(a.x-w.x,a.y-w.y,0);let U=A.length();U?(g.copy(t.object.position).sub(t.target),v.copy(g).normalize(),S.copy(t.object.up).normalize(),I.crossVectors(S,v).normalize(),S.setLength(a.y-w.y),I.setLength(a.x-w.x),A.copy(S.add(I)),s.crossVectors(A,g).normalize(),U*=t.rotateSpeed,h.setFromAxisAngle(s,U),g.applyQuaternion(h),t.object.up.applyQuaternion(h),o.copy(s),x=U):!t.staticMoving&&x&&(x*=Math.sqrt(1-t.dynamicDampingFactor),g.copy(t.object.position).sub(t.target),h.setFromAxisAngle(o,x),g.applyQuaternion(h),t.object.up.applyQuaternion(h)),w.copy(a)}}(),this.zoomCamera=function(){let s;p===r.TOUCH_ZOOM_PAN?(s=b/c,b=c,t.object.isPerspectiveCamera?g.multiplyScalar(s):t.object.isOrthographicCamera?(t.object.zoom=te.clamp(t.object.zoom/s,t.minZoom,t.maxZoom),u!==t.object.zoom&&t.object.updateProjectionMatrix()):console.warn("THREE.TrackballControls: Unsupported camera type")):(s=1+(O.y-_.y)*t.zoomSpeed,s!==1&&s>0&&(t.object.isPerspectiveCamera?g.multiplyScalar(s):t.object.isOrthographicCamera?(t.object.zoom=te.clamp(t.object.zoom/s,t.minZoom,t.maxZoom),u!==t.object.zoom&&t.object.updateProjectionMatrix()):console.warn("THREE.TrackballControls: Unsupported camera type")),t.staticMoving?_.copy(O):_.y+=(O.y-_.y)*this.dynamicDampingFactor)},this.panCamera=function(){const s=new M,h=new C,v=new C;return function(){if(s.copy(E).sub(m),s.lengthSq()){if(t.object.isOrthographicCamera){const I=(t.object.right-t.object.left)/t.object.zoom/t.domElement.clientWidth,A=(t.object.top-t.object.bottom)/t.object.zoom/t.domElement.clientWidth;s.x*=I,s.y*=A}s.multiplyScalar(g.length()*t.panSpeed),v.copy(g).cross(t.object.up).setLength(s.x),v.add(h.copy(t.object.up).setLength(s.y)),t.object.position.add(v),t.target.add(v),t.staticMoving?m.copy(E):m.add(s.subVectors(E,m).multiplyScalar(t.dynamicDampingFactor))}}}(),this.checkDistances=function(){(!t.noZoom||!t.noPan)&&(g.lengthSq()>t.maxDistance*t.maxDistance&&(t.object.position.addVectors(t.target,g.setLength(t.maxDistance)),_.copy(O)),g.lengthSq()<t.minDistance*t.minDistance&&(t.object.position.addVectors(t.target,g.setLength(t.minDistance)),_.copy(O)))},this.update=function(){g.subVectors(t.object.position,t.target),t.noRotate||t.rotateCamera(),t.noZoom||t.zoomCamera(),t.noPan||t.panCamera(),t.object.position.addVectors(t.target,g),t.object.isPerspectiveCamera?(t.checkDistances(),t.object.lookAt(t.target),l.distanceToSquared(t.object.position)>f&&(t.dispatchEvent(X),l.copy(t.object.position))):t.object.isOrthographicCamera?(t.object.lookAt(t.target),(l.distanceToSquared(t.object.position)>f||u!==t.object.zoom)&&(t.dispatchEvent(X),l.copy(t.object.position),u=t.object.zoom)):console.warn("THREE.TrackballControls: Unsupported camera type")},this.reset=function(){p=r.NONE,y=r.NONE,t.target.copy(t.target0),t.object.position.copy(t.position0),t.object.up.copy(t.up0),t.object.zoom=t.zoom0,t.object.updateProjectionMatrix(),g.subVectors(t.object.position,t.target),t.object.lookAt(t.target),t.dispatchEvent(X),l.copy(t.object.position),u=t.object.zoom};function Q(s){t.enabled!==!1&&(d.length===0&&(t.domElement.setPointerCapture(s.pointerId),t.domElement.addEventListener("pointermove",F),t.domElement.addEventListener("pointerup",Z)),pe(s),s.pointerType==="touch"?he(s):ae(s))}function F(s){t.enabled!==!1&&(s.pointerType==="touch"?fe(s):ce(s))}function Z(s){t.enabled!==!1&&(s.pointerType==="touch"?ue(s):le(),J(s),d.length===0&&(t.domElement.releasePointerCapture(s.pointerId),t.domElement.removeEventListener("pointermove",F),t.domElement.removeEventListener("pointerup",Z)))}function G(s){J(s)}function L(s){t.enabled!==!1&&(window.removeEventListener("keydown",L),y===r.NONE&&(s.code===t.keys[r.ROTATE]&&!t.noRotate?y=r.ROTATE:s.code===t.keys[r.ZOOM]&&!t.noZoom?y=r.ZOOM:s.code===t.keys[r.PAN]&&!t.noPan&&(y=r.PAN)))}function V(){t.enabled!==!1&&(y=r.NONE,window.addEventListener("keydown",L))}function ae(s){if(p===r.NONE)switch(s.button){case t.mouseButtons.LEFT:p=r.ROTATE;break;case t.mouseButtons.MIDDLE:p=r.ZOOM;break;case t.mouseButtons.RIGHT:p=r.PAN;break}const h=y!==r.NONE?y:p;h===r.ROTATE&&!t.noRotate?(a.copy(N(s.pageX,s.pageY)),w.copy(a)):h===r.ZOOM&&!t.noZoom?(_.copy(T(s.pageX,s.pageY)),O.copy(_)):h===r.PAN&&!t.noPan&&(m.copy(T(s.pageX,s.pageY)),E.copy(m)),t.dispatchEvent(q)}function ce(s){const h=y!==r.NONE?y:p;h===r.ROTATE&&!t.noRotate?(w.copy(a),a.copy(N(s.pageX,s.pageY))):h===r.ZOOM&&!t.noZoom?O.copy(T(s.pageX,s.pageY)):h===r.PAN&&!t.noPan&&E.copy(T(s.pageX,s.pageY))}function le(){p=r.NONE,t.dispatchEvent(H)}function $(s){if(t.enabled!==!1&&t.noZoom!==!0){switch(s.preventDefault(),s.deltaMode){case 2:_.y-=s.deltaY*.025;break;case 1:_.y-=s.deltaY*.01;break;default:_.y-=s.deltaY*25e-5;break}t.dispatchEvent(q),t.dispatchEvent(H)}}function he(s){switch(ee(s),d.length){case 1:p=r.TOUCH_ROTATE,a.copy(N(d[0].pageX,d[0].pageY)),w.copy(a);break;default:p=r.TOUCH_ZOOM_PAN;const h=d[0].pageX-d[1].pageX,v=d[0].pageY-d[1].pageY;c=b=Math.sqrt(h*h+v*v);const S=(d[0].pageX+d[1].pageX)/2,I=(d[0].pageY+d[1].pageY)/2;m.copy(T(S,I)),E.copy(m);break}t.dispatchEvent(q)}function fe(s){switch(ee(s),d.length){case 1:w.copy(a),a.copy(N(s.pageX,s.pageY));break;default:const h=de(s),v=s.pageX-h.x,S=s.pageY-h.y;c=Math.sqrt(v*v+S*S);const I=(s.pageX+h.x)/2,A=(s.pageY+h.y)/2;E.copy(T(I,A));break}}function ue(s){switch(d.length){case 0:p=r.NONE;break;case 1:p=r.TOUCH_ROTATE,a.copy(N(s.pageX,s.pageY)),w.copy(a);break;case 2:p=r.TOUCH_ZOOM_PAN;for(let h=0;h<d.length;h++)if(d[h].pointerId!==s.pointerId){const v=k[d[h].pointerId];a.copy(N(v.x,v.y)),w.copy(a);break}break}t.dispatchEvent(H)}function K(s){t.enabled!==!1&&s.preventDefault()}function pe(s){d.push(s)}function J(s){delete k[s.pointerId];for(let h=0;h<d.length;h++)if(d[h].pointerId==s.pointerId){d.splice(h,1);return}}function ee(s){let h=k[s.pointerId];h===void 0&&(h=new M,k[s.pointerId]=h),h.set(s.pageX,s.pageY)}function de(s){const h=s.pointerId===d[0].pointerId?d[1]:d[0];return k[h.pointerId]}this.dispose=function(){t.domElement.removeEventListener("contextmenu",K),t.domElement.removeEventListener("pointerdown",Q),t.domElement.removeEventListener("pointercancel",G),t.domElement.removeEventListener("wheel",$),t.domElement.removeEventListener("pointermove",F),t.domElement.removeEventListener("pointerup",Z),window.removeEventListener("keydown",L),window.removeEventListener("keyup",V)},this.domElement.addEventListener("contextmenu",K),this.domElement.addEventListener("pointerdown",Q),this.domElement.addEventListener("pointercancel",G),this.domElement.addEventListener("wheel",$,{passive:!1}),window.addEventListener("keydown",L),window.addEventListener("keyup",V),this.handleResize(),this.update()}}const ie=new C,Ce=new se,ne=new C;class Te extends ye{constructor(i=document.createElement("div")){super(),this.isCSS3DObject=!0,this.element=i,this.element.style.position="absolute",this.element.style.pointerEvents="auto",this.element.style.userSelect="none",this.element.setAttribute("draggable",!1),this.addEventListener("removed",function(){this.traverse(function(n){n.element instanceof Element&&n.element.parentNode!==null&&n.element.parentNode.removeChild(n.element)})})}copy(i,n){return super.copy(i,n),this.element=i.element.cloneNode(!0),this}}class Ie extends Te{constructor(i){super(i),this.isCSS3DSprite=!0,this.rotation2D=0}copy(i,n){return super.copy(i,n),this.rotation2D=i.rotation2D,this}}const P=new re,xe=new re;class Ae{constructor(i={}){const n=this;let t,r,f,l;const u={camera:{style:""},objects:new WeakMap},p=i.element!==void 0?i.element:document.createElement("div");p.style.overflow="hidden",this.domElement=p;const y=document.createElement("div");y.style.transformOrigin="0 0",y.style.pointerEvents="none",p.appendChild(y);const b=document.createElement("div");b.style.transformStyle="preserve-3d",y.appendChild(b),this.getSize=function(){return{width:t,height:r}},this.render=function(a,o){const _=o.projectionMatrix.elements[5]*l;o.view&&o.view.enabled?(y.style.transform=`translate( ${-o.view.offsetX*(t/o.view.width)}px, ${-o.view.offsetY*(r/o.view.height)}px )`,y.style.transform+=`scale( ${o.view.fullWidth/o.view.width}, ${o.view.fullHeight/o.view.height} )`):y.style.transform="",a.matrixWorldAutoUpdate===!0&&a.updateMatrixWorld(),o.parent===null&&o.matrixWorldAutoUpdate===!0&&o.updateMatrixWorld();let O,m;o.isOrthographicCamera&&(O=-(o.right+o.left)/2,m=(o.top+o.bottom)/2);const E=o.view&&o.view.enabled?o.view.height/o.view.fullHeight:1,d=o.isOrthographicCamera?`scale( ${E} )scale(`+_+")translate("+c(O)+"px,"+c(m)+"px)"+x(o.matrixWorldInverse):`scale( ${E} )translateZ(`+_+"px)"+x(o.matrixWorldInverse),T=(o.isPerspectiveCamera?"perspective("+_+"px) ":"")+d+"translate("+f+"px,"+l+"px)";u.camera.style!==T&&(b.style.transform=T,u.camera.style=T),w(a,a,o)},this.setSize=function(a,o){t=a,r=o,f=t/2,l=r/2,p.style.width=a+"px",p.style.height=o+"px",y.style.width=a+"px",y.style.height=o+"px",b.style.width=a+"px",b.style.height=o+"px"};function c(a){return Math.abs(a)<1e-10?0:a}function x(a){const o=a.elements;return"matrix3d("+c(o[0])+","+c(-o[1])+","+c(o[2])+","+c(o[3])+","+c(o[4])+","+c(-o[5])+","+c(o[6])+","+c(o[7])+","+c(o[8])+","+c(-o[9])+","+c(o[10])+","+c(o[11])+","+c(o[12])+","+c(-o[13])+","+c(o[14])+","+c(o[15])+")"}function g(a){const o=a.elements;return"translate(-50%,-50%)"+("matrix3d("+c(o[0])+","+c(o[1])+","+c(o[2])+","+c(o[3])+","+c(-o[4])+","+c(-o[5])+","+c(-o[6])+","+c(-o[7])+","+c(o[8])+","+c(o[9])+","+c(o[10])+","+c(o[11])+","+c(o[12])+","+c(o[13])+","+c(o[14])+","+c(o[15])+")")}function w(a,o,_,O){if(a.isCSS3DObject){const m=a.visible===!0&&a.layers.test(_.layers)===!0;if(a.element.style.display=m===!0?"":"none",m===!0){a.onBeforeRender(n,o,_);let E;a.isCSS3DSprite?(P.copy(_.matrixWorldInverse),P.transpose(),a.rotation2D!==0&&P.multiply(xe.makeRotationZ(a.rotation2D)),a.matrixWorld.decompose(ie,Ce,ne),P.setPosition(ie),P.scale(ne),P.elements[3]=0,P.elements[7]=0,P.elements[11]=0,P.elements[15]=1,E=g(P)):E=g(a.matrixWorld);const d=a.element,k=u.objects.get(a);if(k===void 0||k.style!==E){d.style.transform=E;const T={style:E};u.objects.set(a,T)}d.parentNode!==b&&b.appendChild(d),a.onAfterRender(n,o,_)}}for(let m=0,E=a.children.length;m<E;m++)w(a.children[m],o,_)}}}export{Te as C,ke as T,Ae as a,Ie as b,je as e};
